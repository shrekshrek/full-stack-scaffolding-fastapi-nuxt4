# 新功能开发工作流指南

本指南定义了从构思到部署一个新功能的标准化流程，通过"后端先行"策略提升开发效率。

## 核心理念

**后端先行 (Backend First)**: 先构建和验证后端 API，为前端提供稳定可靠的接口，减少前后端并行开发中的等待和返工。

## 开发流程

### 阶段 0: 规划与设计

**目标**: 明确功能需求，评估工作量，设计技术方案。

1. **需求分析**: 与团队沟通，明确功能目标和范围
2. **技术设计**:
   - **数据库**: 设计需要的新表和关系
   - **API**: 定义路由端点（URL、HTTP方法）
   - **权限**: 确定需要的权限控制
3. **工作量评估**: 拆分任务，估算时间

### 阶段 1: 后端开发

**目标**: 实现并交付稳定可靠的 API 端点。

1. **启动开发环境**: 运行 `pnpm dev`
2. **实现步骤**:
   - **数据模型**: 在 `backend/src/.../models.py` 中定义 SQLAlchemy 模型
   - **数据库迁移**: 使用 `pnpm be:migrate:make "描述"` 生成迁移，`pnpm be:migrate:up` 应用
   - **业务逻辑**: 在 `service.py` 中实现核心业务逻辑
   - **API 路由**: 在 `router.py` 中创建端点，`schemas.py` 定义请求/响应模型
3. **API 测试**: 使用 `http://localhost:8000/docs` 的 Swagger UI 测试所有端点

### 阶段 2: 前端开发

**目标**: 基于已交付的 API，构建用户界面。

1. **API 调用封装**: 在对应模块的 `composables` 中封装 API 调用
2. **组件与页面开发**: 创建 Vue 组件和页面
3. **状态管理**: 如需要，使用 Pinia 管理状态

### 阶段 3: 联调与部署

**目标**: 完成测试，确保质量，部署上线。

1. **端到端测试**: 在本地环境测试完整用户流程
2. **代码审查**: 创建 Pull Request，团队审查
3. **合并与部署**: 审查通过后合并主分支，根据 CI/CD 流程自动部署

## 相关文档

- 模块开发详见：[模块化开发指南](./MODULAR_DEVELOPMENT.md)
- 后端规范详见：[后端开发规范](../backend/CODING_GUIDE.md)
- 前端规范详见：[前端开发规范](../frontend/CODING_GUIDE.md) 